@page "/"
@using SharpCards.Models
@inject CardsService CardsService;

<PageTitle>Index</PageTitle>

<h1>Cards!</h1>
@if (CardsService.Cards.Count < 0)
{
    <p>
        <em>Loading...</em>
    </p>
} else
{
    <button class="btn btn-primary" @onclick="GetRandom">Give me random!</button>
    <CardDetails Card=_currentCard/>
}

@code {
    private Card _currentCard = new();

    protected override async Task OnInitializedAsync()
    {
        if (!CardsService.IsInitialized)
        {
            await CardsService.Init();
        }
        var cards = CardsService.Cards.ToArray();
        _currentCard = CardsService.Cards.First();
    }

    private void GetRandom()
    {
        _currentCard = CardsService.Cards.Where(c => c.Id != _currentCard.Id).ElementAt(new Random().Next(0, CardsService.Cards.Count - 1));
    }
}