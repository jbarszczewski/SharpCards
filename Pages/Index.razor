@page "/"
@inject CardsService cardsService;
@using SharpCards.Models;

<PageTitle>Index</PageTitle>

<h1>Cards!</h1>
@if (cards == null)
{
	<p><em>Loading...</em></p>
}
else
{
	<button class="btn btn-primary" @onclick="GetRandom">Give me random!</button>
	<CardDetails Card=currentCard />
}
@code {
	private Card currentCard = new Card();

	private Card[]? cards;

	protected override async Task OnInitializedAsync()
	{
		cards = await cardsService.GetCards();
		currentCard = cards != null ? cards[0] : new Card
		{
			Id = Guid.Empty,
			FrontText = "Front: No cards found",
			BackText = "Back: No cards found"
		};
	}

	private void GetRandom()
	{
		currentCard = cards != null ? cards.Where(c => c.Id != currentCard.Id).ToArray()[new Random().Next(0, cards.Length - 1)]
		: new Card
		{
			Id = Guid.Empty,
			FrontText = "Front: No cards found",
			BackText = "Back: No cards found"
		};
	}
}