@page "/"
@inject CardsService CardsService;
@using SharpCards.Models;
@using SharpCards.Database;

<PageTitle>Index</PageTitle>

<h1>Cards!</h1>
@if (CardsService.Cards.Count < 0)
{
	<p><em>Loading...</em></p>
}
else
{
	<button class="btn btn-primary" @onclick="GetRandom">Give me random!</button>
	<CardDetails Card=currentCard />
}
@code {
	private Card currentCard = new Card();

	protected override async Task OnInitializedAsync()
	{
		if (CardsService.Cards.Count == 0)
		{
			await CardsService.Init();		
		}

		currentCard = CardsService.Cards.First();
	}

	private void GetRandom()
	{
		currentCard = CardsService.Cards.Where(c => c.Id != currentCard.Id).ToArray()[new Random().Next(0, CardsService.Cards.Count - 1)];
	}
}